/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ai/chat/route";
exports.ids = ["app/api/ai/chat/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fai%2Fchat%2Froute&page=%2Fapi%2Fai%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fchat%2Froute.ts&appDir=D%3A%5CHelix%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CHelix&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fai%2Fchat%2Froute&page=%2Fapi%2Fai%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fchat%2Froute.ts&appDir=D%3A%5CHelix%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CHelix&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/./node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/./node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/./node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/./node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/./node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/./node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/./node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/./node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/./node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/./node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/./node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var D_Helix_src_app_api_ai_chat_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./src/app/api/ai/chat/route.ts */ \"(rsc)/./src/app/api/ai/chat/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ai/chat/route\",\n        pathname: \"/api/ai/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/ai/chat/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"D:\\\\Helix\\\\src\\\\app\\\\api\\\\ai\\\\chat\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Helix_src_app_api_ai_chat_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/ai/chat/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        // if we aren't wrapped by base-server handle here\n        if (!activeSpan && !(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhaSUyRmNoYXQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFpJTJGY2hhdCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFpJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDSGVsaXglNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNIZWxpeCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCZpc0dsb2JhbE5vdEZvdW5kRW5hYmxlZD0hIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ2Q7QUFDUztBQUNPO0FBQ0s7QUFDbUM7QUFDakQ7QUFDTztBQUNmO0FBQ3NDO0FBQ3pCO0FBQ007QUFDQztBQUNoQjtBQUNPO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLGFBQWEsT0FBb0MsSUFBSSxDQUFFO0FBQ3ZELHdCQUF3QixNQUF1QztBQUMvRDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUMwRjtBQUNuRjtBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLEtBQXFCLEVBQUUsRUFFMUIsQ0FBQztBQUNOO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixLQUF3QztBQUN2RTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxvSkFBb0o7QUFDaEssOEJBQThCLDZGQUFnQjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNkZBQWU7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsNEVBQVM7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLDhCQUE4Qiw2RUFBYztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsNEVBQWU7QUFDM0MsNEJBQTRCLDZFQUFnQjtBQUM1QyxvQkFBb0IseUdBQWtCLGtDQUFrQyxpSEFBc0I7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSxnRkFBYztBQUMvRSwrREFBK0QseUNBQXlDO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DLFFBQVEsRUFBRSxNQUFNO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0Esa0JBQWtCO0FBQ2xCLHVDQUF1QyxRQUFRLEVBQUUsUUFBUTtBQUN6RDtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0Msb0JBQW9CO0FBQ25FO0FBQ0EseUJBQXlCLDZFQUFjO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0Msc0ZBQXlCO0FBQ2pFO0FBQ0Esb0NBQW9DLDRFQUFzQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNKQUFzSixvRUFBYztBQUNwSywwSUFBMEksb0VBQWM7QUFDeEo7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLDZFQUFlO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQSw4QkFBOEIsNkVBQVk7QUFDMUM7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QywyRkFBbUI7QUFDakU7QUFDQTtBQUNBLDZCQUE2QjtBQUM3Qix5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixrRUFBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFJQUFxSSw2RUFBZTtBQUNwSjtBQUNBLDJHQUEyRyxpSEFBaUg7QUFDNU47QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsaUJBQWlCLDZFQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix3RkFBMkI7QUFDdkQsa0JBQWtCLDZFQUFjO0FBQ2hDLCtCQUErQiw0RUFBc0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsMEZBQXFCO0FBQ2xFO0FBQ0Esa0JBQWtCLDZFQUFZO0FBQzlCO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsNENBQTRDLDZGQUFlO0FBQzNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLDJGQUFtQjtBQUNyRDtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyw2RUFBWTtBQUMxQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgeyBnZXRSZXF1ZXN0TWV0YSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JlcXVlc3QtbWV0YVwiO1xuaW1wb3J0IHsgZ2V0VHJhY2VyLCBTcGFuS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS90cmFjZXJcIjtcbmltcG9ydCB7IG5vcm1hbGl6ZUFwcFBhdGggfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvcm91dGVyL3V0aWxzL2FwcC1wYXRoc1wiO1xuaW1wb3J0IHsgTm9kZU5leHRSZXF1ZXN0LCBOb2RlTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYmFzZS1odHRwL25vZGVcIjtcbmltcG9ydCB7IE5leHRSZXF1ZXN0QWRhcHRlciwgc2lnbmFsRnJvbU5vZGVSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi9zcGVjLWV4dGVuc2lvbi9hZGFwdGVycy9uZXh0LXJlcXVlc3RcIjtcbmltcG9ydCB7IEJhc2VTZXJ2ZXJTcGFuIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgZ2V0UmV2YWxpZGF0ZVJlYXNvbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2luc3RydW1lbnRhdGlvbi91dGlsc1wiO1xuaW1wb3J0IHsgc2VuZFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvc2VuZC1yZXNwb25zZVwiO1xuaW1wb3J0IHsgZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzLCB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvd2ViL3V0aWxzXCI7XG5pbXBvcnQgeyBnZXRDYWNoZUNvbnRyb2xIZWFkZXIgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvY2FjaGUtY29udHJvbFwiO1xuaW1wb3J0IHsgSU5GSU5JVEVfQ0FDSEUsIE5FWFRfQ0FDSEVfVEFHU19IRUFERVIgfSBmcm9tIFwibmV4dC9kaXN0L2xpYi9jb25zdGFudHNcIjtcbmltcG9ydCB7IE5vRmFsbGJhY2tFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9uby1mYWxsYmFjay1lcnJvci5leHRlcm5hbFwiO1xuaW1wb3J0IHsgQ2FjaGVkUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcmVzcG9uc2UtY2FjaGVcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJEOlxcXFxIZWxpeFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhaVxcXFxjaGF0XFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9haS9jaGF0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYWkvY2hhdFwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYWkvY2hhdC9yb3V0ZVwiXG4gICAgfSxcbiAgICBkaXN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfRElTVF9ESVIgfHwgJycsXG4gICAgcmVsYXRpdmVQcm9qZWN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfUFJPSkVDVF9ESVIgfHwgJycsXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxIZWxpeFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhaVxcXFxjaGF0XFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMsIGN0eCkge1xuICAgIHZhciBfbmV4dENvbmZpZ19leHBlcmltZW50YWw7XG4gICAgbGV0IHNyY1BhZ2UgPSBcIi9hcGkvYWkvY2hhdC9yb3V0ZVwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9IGVsc2UgaWYgKHNyY1BhZ2UgPT09ICcvaW5kZXgnKSB7XG4gICAgICAgIC8vIHdlIGFsd2F5cyBub3JtYWxpemUgL2luZGV4IHNwZWNpZmljYWxseVxuICAgICAgICBzcmNQYWdlID0gJy8nO1xuICAgIH1cbiAgICBjb25zdCBtdWx0aVpvbmVEcmFmdE1vZGUgPSBwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFO1xuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2UsXG4gICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgeyBidWlsZElkLCBwYXJhbXMsIG5leHRDb25maWcsIGlzRHJhZnRNb2RlLCBwcmVyZW5kZXJNYW5pZmVzdCwgcm91dGVyU2VydmVyQ29udGV4dCwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCByZXNvbHZlZFBhdGhuYW1lIH0gPSBwcmVwYXJlUmVzdWx0O1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRTcmNQYWdlID0gbm9ybWFsaXplQXBwUGF0aChzcmNQYWdlKTtcbiAgICBsZXQgaXNJc3IgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LmR5bmFtaWNSb3V0ZXNbbm9ybWFsaXplZFNyY1BhZ2VdIHx8IHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgaWYgKGlzSXNyICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjb25zdCBpc1ByZXJlbmRlcmVkID0gQm9vbGVhbihwcmVyZW5kZXJNYW5pZmVzdC5yb3V0ZXNbcmVzb2x2ZWRQYXRobmFtZV0pO1xuICAgICAgICBjb25zdCBwcmVyZW5kZXJJbmZvID0gcHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV07XG4gICAgICAgIGlmIChwcmVyZW5kZXJJbmZvKSB7XG4gICAgICAgICAgICBpZiAocHJlcmVuZGVySW5mby5mYWxsYmFjayA9PT0gZmFsc2UgJiYgIWlzUHJlcmVuZGVyZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm9GYWxsYmFja0Vycm9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IGNhY2hlS2V5ID0gbnVsbDtcbiAgICBpZiAoaXNJc3IgJiYgIXJvdXRlTW9kdWxlLmlzRGV2ICYmICFpc0RyYWZ0TW9kZSkge1xuICAgICAgICBjYWNoZUtleSA9IHJlc29sdmVkUGF0aG5hbWU7XG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XG4gICAgICAgIGNhY2hlS2V5ID0gY2FjaGVLZXkgPT09ICcvaW5kZXgnID8gJy8nIDogY2FjaGVLZXk7XG4gICAgfVxuICAgIGNvbnN0IHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlID0gLy8gSWYgd2UncmUgaW4gZGV2ZWxvcG1lbnQsIHdlIGFsd2F5cyBzdXBwb3J0IGR5bmFtaWMgSFRNTFxuICAgIHJvdXRlTW9kdWxlLmlzRGV2ID09PSB0cnVlIHx8IC8vIElmIHRoaXMgaXMgbm90IFNTRyBvciBkb2VzIG5vdCBoYXZlIHN0YXRpYyBwYXRocywgdGhlbiBpdCBzdXBwb3J0c1xuICAgIC8vIGR5bmFtaWMgSFRNTC5cbiAgICAhaXNJc3I7XG4gICAgLy8gVGhpcyBpcyBhIHJldmFsaWRhdGlvbiByZXF1ZXN0IGlmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpY1xuICAgIC8vIHBhZ2UgYW5kIGl0IGlzIG5vdCBiZWluZyByZXN1bWVkIGZyb20gYSBwb3N0cG9uZWQgcmVuZGVyIGFuZFxuICAgIC8vIGl0IGlzIG5vdCBhIGR5bmFtaWMgUlNDIHJlcXVlc3QgdGhlbiBpdCBpcyBhIHJldmFsaWRhdGlvblxuICAgIC8vIHJlcXVlc3QuXG4gICAgY29uc3QgaXNSZXZhbGlkYXRlID0gaXNJc3IgJiYgIXN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlO1xuICAgIGNvbnN0IG1ldGhvZCA9IHJlcS5tZXRob2QgfHwgJ0dFVCc7XG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgY29uc3QgYWN0aXZlU3BhbiA9IHRyYWNlci5nZXRBY3RpdmVTY29wZVNwYW4oKTtcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgICBwYXJhbXMsXG4gICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICByZW5kZXJPcHRzOiB7XG4gICAgICAgICAgICBleHBlcmltZW50YWw6IHtcbiAgICAgICAgICAgICAgICBjYWNoZUNvbXBvbmVudHM6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwuY2FjaGVDb21wb25lbnRzKSxcbiAgICAgICAgICAgICAgICBhdXRoSW50ZXJydXB0czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5hdXRoSW50ZXJydXB0cylcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZSxcbiAgICAgICAgICAgIGluY3JlbWVudGFsQ2FjaGU6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2luY3JlbWVudGFsQ2FjaGUnKSxcbiAgICAgICAgICAgIGNhY2hlTGlmZVByb2ZpbGVzOiAoX25leHRDb25maWdfZXhwZXJpbWVudGFsID0gbmV4dENvbmZpZy5leHBlcmltZW50YWwpID09IG51bGwgPyB2b2lkIDAgOiBfbmV4dENvbmZpZ19leHBlcmltZW50YWwuY2FjaGVMaWZlLFxuICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsLFxuICAgICAgICAgICAgb25DbG9zZTogKGNiKT0+e1xuICAgICAgICAgICAgICAgIHJlcy5vbignY2xvc2UnLCBjYik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb25BZnRlclRhc2tFcnJvcjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgb25JbnN0cnVtZW50YXRpb25SZXF1ZXN0RXJyb3I6IChlcnJvciwgX3JlcXVlc3QsIGVycm9yQ29udGV4dCk9PnJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyb3IsIGVycm9yQ29udGV4dCwgcm91dGVyU2VydmVyQ29udGV4dClcbiAgICAgICAgfSxcbiAgICAgICAgc2hhcmVkQ29udGV4dDoge1xuICAgICAgICAgICAgYnVpbGRJZFxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBub2RlTmV4dFJlcSA9IG5ldyBOb2RlTmV4dFJlcXVlc3QocmVxKTtcbiAgICBjb25zdCBub2RlTmV4dFJlcyA9IG5ldyBOb2RlTmV4dFJlc3BvbnNlKHJlcyk7XG4gICAgY29uc3QgbmV4dFJlcSA9IE5leHRSZXF1ZXN0QWRhcHRlci5mcm9tTm9kZU5leHRSZXF1ZXN0KG5vZGVOZXh0UmVxLCBzaWduYWxGcm9tTm9kZVJlc3BvbnNlKHJlcykpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGludm9rZVJvdXRlTW9kdWxlID0gYXN5bmMgKHNwYW4pPT57XG4gICAgICAgICAgICByZXR1cm4gcm91dGVNb2R1bGUuaGFuZGxlKG5leHRSZXEsIGNvbnRleHQpLmZpbmFsbHkoKCk9PntcbiAgICAgICAgICAgICAgICBpZiAoIXNwYW4pIHJldHVybjtcbiAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAnaHR0cC5zdGF0dXNfY29kZSc6IHJlcy5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICAgICAgICAnbmV4dC5yc2MnOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvb3RTcGFuQXR0cmlidXRlcyA9IHRyYWNlci5nZXRSb290U3BhbkF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgICAgICAvLyBXZSB3ZXJlIHVuYWJsZSB0byBnZXQgYXR0cmlidXRlcywgcHJvYmFibHkgT1RFTCBpcyBub3QgZW5hYmxlZFxuICAgICAgICAgICAgICAgIGlmICghcm9vdFNwYW5BdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJykgIT09IEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBVbmV4cGVjdGVkIHJvb3Qgc3BhbiB0eXBlICcke3Jvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQuc3Bhbl90eXBlJyl9Jy4gUGxlYXNlIHJlcG9ydCB0aGlzIE5leHQuanMgaXNzdWUgaHR0cHM6Ly9naXRodWIuY29tL3ZlcmNlbC9uZXh0LmpzYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3Qgcm91dGUgPSByb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnJvdXRlJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHttZXRob2R9ICR7cm91dGV9YDtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnaHR0cC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQuc3Bhbl9uYW1lJzogbmFtZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKG5hbWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShgJHttZXRob2R9ICR7cmVxLnVybH1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoY3VycmVudFNwYW4pPT57XG4gICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWU7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZUdlbmVyYXRvciA9IGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeSB9KT0+e1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiBpc09uRGVtYW5kUmV2YWxpZGF0ZSAmJiByZXZhbGlkYXRlT25seUdlbmVyYXRlZCAmJiAhcHJldmlvdXNDYWNoZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsICdSRVZBTElEQVRFRCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBpbnZva2VSb3V0ZU1vZHVsZShjdXJyZW50U3Bhbik7XG4gICAgICAgICAgICAgICAgICAgIHJlcS5mZXRjaE1ldHJpY3MgPSBjb250ZXh0LnJlbmRlck9wdHMuZmV0Y2hNZXRyaWNzO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGVuZGluZ1dhaXRVbnRpbCA9IGNvbnRleHQucmVuZGVyT3B0cy5wZW5kaW5nV2FpdFVudGlsO1xuICAgICAgICAgICAgICAgICAgICAvLyBBdHRlbXB0IHVzaW5nIHByb3ZpZGVkIHdhaXRVbnRpbCBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgaXQncyBub3Qgd2UgZmFsbGJhY2sgdG8gc2VuZFJlc3BvbnNlJ3MgaGFuZGxpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdXYWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdHgud2FpdFVudGlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R4LndhaXRVbnRpbChwZW5kaW5nV2FpdFVudGlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nV2FpdFVudGlsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlVGFncyA9IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRUYWdzO1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmVxdWVzdCBpcyBmb3IgYSBzdGF0aWMgcmVzcG9uc2UsIHdlIGNhbiBjYWNoZSBpdCBzbyBsb25nXG4gICAgICAgICAgICAgICAgICAgIC8vIGFzIGl0J3Mgbm90IGVkZ2UuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0lzcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvcHkgdGhlIGhlYWRlcnMgZnJvbSB0aGUgcmVzcG9uc2UuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyhyZXNwb25zZS5oZWFkZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYWNoZVRhZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW05FWFRfQ0FDSEVfVEFHU19IRUFERVJdID0gY2FjaGVUYWdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoZWFkZXJzWydjb250ZW50LXR5cGUnXSAmJiBibG9iLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzWydjb250ZW50LXR5cGUnXSA9IGJsb2IudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmFsaWRhdGUgPSB0eXBlb2YgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlID49IElORklOSVRFX0NBQ0hFID8gZmFsc2UgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID09PSAndW5kZWZpbmVkJyB8fCBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlID49IElORklOSVRFX0NBQ0hFID8gdW5kZWZpbmVkIDogY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZEV4cGlyZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgY2FjaGUgZW50cnkgZm9yIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEJ1ZmZlci5mcm9tKGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBpcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlRW50cnk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIHJlc3BvbnNlIHdpdGhvdXQgY2FjaGluZyBpZiBub3QgSVNSXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBzZW5kUmVzcG9uc2Uobm9kZU5leHRSZXEsIG5vZGVOZXh0UmVzLCByZXNwb25zZSwgY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgcmVxdWVzdCBlcnJvciBoZXJlIGFzIGl0IHdvbid0IGJlIGJ1YmJsZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNDYWNoZUVudHJ5LmlzU3RhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVyS2luZDogJ0FwcCBSb3V0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBjYWNoZUVudHJ5ID0gYXdhaXQgcm91dGVNb2R1bGUuaGFuZGxlUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxuICAgICAgICAgICAgICAgIGNhY2hlS2V5LFxuICAgICAgICAgICAgICAgIHJvdXRlS2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwcmVyZW5kZXJNYW5pZmVzdCxcbiAgICAgICAgICAgICAgICBpc1JvdXRlUFBSRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VHZW5lcmF0b3IsXG4gICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIHdlIGRvbid0IGNyZWF0ZSBhIGNhY2hlRW50cnkgZm9yIElTUlxuICAgICAgICAgICAgaWYgKCFpc0lzcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUua2luZCkgIT09IENhY2hlZFJvdXRlS2luZC5BUFBfUk9VVEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2NhY2hlRW50cnlfdmFsdWUxO1xuICAgICAgICAgICAgICAgIHRocm93IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXcgRXJyb3IoYEludmFyaWFudDogYXBwLXJvdXRlIHJlY2VpdmVkIGludmFsaWQgY2FjaGUgZW50cnkgJHtjYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiAoX2NhY2hlRW50cnlfdmFsdWUxID0gY2FjaGVFbnRyeS52YWx1ZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9jYWNoZUVudHJ5X3ZhbHVlMS5raW5kfWApLCBcIl9fTkVYVF9FUlJPUl9DT0RFXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiRTcwMVwiLFxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsIGlzT25EZW1hbmRSZXZhbGlkYXRlID8gJ1JFVkFMSURBVEVEJyA6IGNhY2hlRW50cnkuaXNNaXNzID8gJ01JU1MnIDogY2FjaGVFbnRyeS5pc1N0YWxlID8gJ1NUQUxFJyA6ICdISVQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERyYWZ0IG1vZGUgc2hvdWxkIG5ldmVyIGJlIGNhY2hlZFxuICAgICAgICAgICAgaWYgKGlzRHJhZnRNb2RlKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICdwcml2YXRlLCBuby1jYWNoZSwgbm8tc3RvcmUsIG1heC1hZ2U9MCwgbXVzdC1yZXZhbGlkYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gZnJvbU5vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKGNhY2hlRW50cnkudmFsdWUuaGVhZGVycyk7XG4gICAgICAgICAgICBpZiAoIShnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzSXNyKSkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMuZGVsZXRlKE5FWFRfQ0FDSEVfVEFHU19IRUFERVIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgY2FjaGUgY29udHJvbCBpcyBhbHJlYWR5IHNldCBvbiB0aGUgcmVzcG9uc2Ugd2UgZG9uJ3RcbiAgICAgICAgICAgIC8vIG92ZXJyaWRlIGl0IHRvIGFsbG93IHVzZXJzIHRvIGN1c3RvbWl6ZSBpdCB2aWEgbmV4dC5jb25maWdcbiAgICAgICAgICAgIGlmIChjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCAmJiAhcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpICYmICFoZWFkZXJzLmdldCgnQ2FjaGUtQ29udHJvbCcpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCBnZXRDYWNoZUNvbnRyb2xIZWFkZXIoY2FjaGVFbnRyeS5jYWNoZUNvbnRyb2wpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShjYWNoZUVudHJ5LnZhbHVlLmJvZHksIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIHN0YXR1czogY2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMgfHwgMjAwXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKGFjdGl2ZVNwYW4pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gaWYgd2UgYXJlbid0IHdyYXBwZWQgYnkgYmFzZS1zZXJ2ZXIgaGFuZGxlIGhlcmVcbiAgICAgICAgaWYgKCFhY3RpdmVTcGFuICYmICEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgcm91dGVQYXRoOiBub3JtYWxpemVkU3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyb3V0ZScsXG4gICAgICAgICAgICAgICAgcmV2YWxpZGF0ZVJlYXNvbjogZ2V0UmV2YWxpZGF0ZVJlYXNvbih7XG4gICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIC8vIElmIHRoaXMgaXMgZHVyaW5nIHN0YXRpYyBnZW5lcmF0aW9uLCB0aHJvdyB0aGUgZXJyb3IgYWdhaW4uXG4gICAgICAgIGlmIChpc0lzcikgdGhyb3cgZXJyO1xuICAgICAgICAvLyBPdGhlcndpc2UsIHNlbmQgYSA1MDAgcmVzcG9uc2UuXG4gICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fai%2Fchat%2Froute&page=%2Fapi%2Fai%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fchat%2Froute.ts&appDir=D%3A%5CHelix%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CHelix&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/ai/chat/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/ai/chat/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! child_process */ \"child_process\");\n/* harmony import */ var child_process__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(child_process__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! util */ \"util\");\n/* harmony import */ var util__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(util__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst execAsync = (0,util__WEBPACK_IMPORTED_MODULE_2__.promisify)(child_process__WEBPACK_IMPORTED_MODULE_1__.exec);\n// NVIDIA API configuration\nconst NVIDIA_API_KEY = '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';\nconst NVIDIA_BASE_URL = 'https://integrate.api.nvidia.com/v1';\nasync function POST(request) {\n    try {\n        const { message, context, model = 'auto', conversationHistory = [], projectId, chatMode = 'ask' } = await request.json();\n        // Auto model selection logic\n        let selectedModel = model;\n        if (model === 'auto') {\n            // Smart model selection based on context\n            const isCodeRelated = /\\b(code|function|class|import|export|const|let|var|if|for|while|return)\\b/i.test(message);\n            const isLongTask = message.length > 200 || /\\b(build|create|implement|develop|design)\\b/i.test(message);\n            if (isCodeRelated) {\n                selectedModel = 'qwen/qwen3-coder-480b-a35b-instruct';\n            } else if (isLongTask) {\n                selectedModel = 'nvidia/llama-3.3-nemotron-super-49b-v1.5';\n            } else {\n                selectedModel = 'meta/llama-3.2-3b-instruct';\n            }\n        }\n        // Content filtering - only allow coding related questions\n        const codingKeywords = [\n            'code',\n            'programming',\n            'javascript',\n            'typescript',\n            'html',\n            'css',\n            'react',\n            'next',\n            'component',\n            'function',\n            'variable',\n            'api',\n            'database',\n            'frontend',\n            'backend',\n            'debug',\n            'error',\n            'bug',\n            'fix',\n            'build',\n            'deploy',\n            'git',\n            'npm',\n            'yarn',\n            'algorithm',\n            'data structure',\n            'class',\n            'object',\n            'array',\n            'string',\n            'number',\n            'boolean',\n            'async',\n            'await',\n            'promise',\n            'callback',\n            'event',\n            'dom',\n            'json',\n            'xml',\n            'http',\n            'https',\n            'rest',\n            'graphql',\n            'sql',\n            'nosql',\n            'mongodb',\n            'firebase',\n            'auth',\n            'login',\n            'register',\n            'session',\n            'token',\n            'jwt',\n            'oauth',\n            'security',\n            'performance',\n            'optimization',\n            'responsive',\n            'mobile',\n            'desktop',\n            'browser',\n            'server',\n            'client',\n            'framework',\n            'library',\n            'package',\n            'module',\n            'import',\n            'export',\n            'interface',\n            'type',\n            'enum',\n            'generic',\n            'inheritance',\n            'polymorphism',\n            'encapsulation',\n            'abstraction',\n            'design pattern',\n            'mvc',\n            'mvvm',\n            'crud',\n            'game',\n            'animation',\n            'graphics',\n            'canvas',\n            'webgl',\n            'three.js',\n            'socket',\n            'websocket',\n            'real-time',\n            'live',\n            'stream',\n            'video',\n            'audio',\n            'media',\n            'style',\n            'styling',\n            'layout',\n            'responsive',\n            'flexbox',\n            'grid',\n            'bootstrap',\n            'tailwind',\n            'sass',\n            'scss',\n            'less',\n            'webpack',\n            'vite',\n            'rollup',\n            'babel',\n            'eslint',\n            'prettier',\n            'typescript',\n            'testing',\n            'jest',\n            'cypress',\n            'playwright',\n            'docker',\n            'kubernetes',\n            'aws',\n            'azure',\n            'gcp',\n            'heroku',\n            'vercel',\n            'netlify'\n        ];\n        const isCodingRelated = codingKeywords.some((keyword)=>message.toLowerCase().includes(keyword.toLowerCase())) || /\\b(create|build|make|develop|implement|design|write|generate)\\b.*\\b(app|website|game|component|function|script|program|software|system|file|folder|page|route|api|database|ui|interface)\\b/i.test(message) || /\\b(how to|how do I|how can I)\\b.*\\b(code|program|build|create|implement|design|develop)\\b/i.test(message) || /\\b(what is|explain|tutorial|learn)\\b.*\\b(javascript|typescript|react|html|css|programming|coding|development)\\b/i.test(message) || /\\b(help|assist|support)\\b.*\\b(code|coding|programming|development|debug|error|bug)\\b/i.test(message);\n        if (!isCodingRelated && chatMode !== 'agent') {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                response: \"I'm your coding assistant! I specialize in helping with programming, web development, software engineering, and technical implementation. Please ask me questions related to:\\n\\n Programming languages (JavaScript, TypeScript, Python, etc.)\\n Web development (HTML, CSS, React, Next.js, etc.)\\n Software engineering and architecture\\n Debugging and troubleshooting\\n Code optimization and best practices\\n Development tools and workflows\\n Building apps, websites, and games\\n\\nWhat would you like to code today?\",\n                codeBlocks: [],\n                filesToCreate: [],\n                filesToUpdate: [],\n                fileReadResults: [],\n                fileUpdateResults: [],\n                fileDeletionResults: [],\n                folderCreationResults: [],\n                terminalResults: [],\n                previewRequests: [],\n                userQuestions: [],\n                model: selectedModel\n            });\n        }\n        // Generate system prompt based on project context and chat mode\n        let systemPrompt = '';\n        if (chatMode === 'agent') {\n            systemPrompt = `You are Helix AI Agent, a direct coding assistant that builds what users ask for.\n\nSIMPLE RULES:\n- Be conversational and direct\n- Build complete, working solutions\n- Create multiple files for games/apps (HTML, CSS, JS separately)\n- Use modern JavaScript and best practices\n- Make functional code that actually works\n\nCREATE FILES:\n\\`\\`\\`html\n// [filepath].html\n[complete HTML]\n\\`\\`\\`\n\n\\`\\`\\`css\n// [filepath].css\n[complete CSS]\n\\`\\`\\`\n\n\\`\\`\\`javascript\n// [filepath].js\n[complete JavaScript]\n\\`\\`\\`\n\n\\`\\`\\`tsx\n// [filepath].tsx\n[React component]\n\\`\\`\\`\n\nPROJECT: Next.js 15.5.3, TypeScript, Tailwind CSS, Firebase Auth\nFILES: ${context?.files?.map((f)=>`${f.name}`).join(', ') || 'None'}\n\nBuild it now!`;\n        } else {\n            systemPrompt = `You are Helix AI, a helpful coding assistant that talks like a developer friend.\n\nBE HELPFUL:\n- Answer questions clearly\n- Provide working code examples\n- Explain concepts simply\n- Suggest best practices\n- Be conversational and friendly\n\nPROJECT: Next.js 15.5.3, TypeScript, Tailwind CSS, Firebase Auth\nFILES: ${context?.files?.map((f)=>`${f.name}`).join(', ') || 'None'}\n\nHelp the developer succeed!`;\n        }\n        let response = '';\n        try {\n            // Use NVIDIA API\n            const requestBody = {\n                model: selectedModel,\n                messages: [\n                    {\n                        role: 'system',\n                        content: systemPrompt\n                    },\n                    ...conversationHistory.slice(-5),\n                    {\n                        role: 'user',\n                        content: message\n                    }\n                ],\n                temperature: selectedModel.includes('nemotron') ? 0.6 : 0.7,\n                top_p: selectedModel.includes('nemotron') ? 0.95 : 0.8,\n                max_tokens: selectedModel.includes('nemotron') ? 65536 : 4096,\n                stream: false\n            };\n            const nvidiaResponse = await fetch(`${NVIDIA_BASE_URL}/chat/completions`, {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${NVIDIA_API_KEY}`,\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(requestBody)\n            });\n            if (!nvidiaResponse.ok) {\n                throw new Error(`NVIDIA API Error: ${nvidiaResponse.status} ${nvidiaResponse.statusText}`);\n            }\n            const nvidiaData = await nvidiaResponse.json();\n            response = nvidiaData.choices?.[0]?.message?.content || 'No response generated';\n            // Remove any formal structure and robotic language\n            response = response.replace(/<think>[\\s\\S]*?<\\/think>/gi, '');\n            response = response.replace(/\\*\\*Reasoning:\\*\\*[\\s\\S]*?(?=\\n\\n|$)/gi, '');\n            response = response.replace(/^.*?thinking.*?$/gmi, '');\n            response = response.replace(/\\s*CODING\\s*MODE\\s*ACTIVATED/gi, '');\n            response = response.replace(/\\s*CONVERSATION\\s*MODE/gi, '');\n            response = response.replace(/\\*\\*Explanation:\\*\\*/gi, '');\n            response = response.replace(/\\*\\*Next Steps:\\*\\*/gi, '');\n            response = response.replace(/^\\s*-\\s*.*$/gm, (match)=>{\n                // Only remove bullet points that look like formal explanations\n                if (match.includes('file') || match.includes('HTML') || match.includes('CSS') || match.includes('JavaScript')) {\n                    return '';\n                }\n                return match;\n            });\n            response = response.trim();\n        } catch (aiError) {\n            console.error('AI Generation Error:', aiError);\n            response = 'I apologize, but I encountered an error while processing your request. Please try again or rephrase your question.';\n        }\n        // Extract code blocks and commands\n        const codeBlockRegex = /```(?:(\\w+)\\s*)?(?:\\n|\\r\\n)?([\\s\\S]*?)```/g;\n        const codeBlocks = [];\n        const filesToCreate = [];\n        const filesToUpdate = [];\n        const filesToRead = [];\n        const filesToDelete = [];\n        const foldersToCreate = [];\n        const terminalCommands = [];\n        const previewRequests = [];\n        const userQuestions = [];\n        let match;\n        // Extract code blocks\n        while((match = codeBlockRegex.exec(response)) !== null){\n            const language = match[1] || 'text';\n            const code = match[2].trim();\n            // Check if it's a terminal command\n            if (language === 'terminal' || language === 'bash' || language === 'cmd') {\n                terminalCommands.push({\n                    command: code,\n                    language\n                });\n            } else if (language === 'read-file') {\n                // File reading request\n                filesToRead.push(code);\n            } else if (language === 'delete-file') {\n                // File deletion request\n                filesToDelete.push(code);\n            } else if (language === 'create-folder') {\n                // Folder creation request\n                foldersToCreate.push(code);\n            } else if (language === 'preview') {\n                // Preview request\n                previewRequests.push(code);\n            } else if (language === 'question') {\n                // User question\n                userQuestions.push(code);\n            } else {\n                codeBlocks.push({\n                    language,\n                    code\n                });\n            }\n        }\n        // Enhanced file creation and update instructions parsing\n        const fileInstructionPatterns = [\n            /(?:I'll create|I'll make|Creating|Let me create|I'll add|I'll build).*?(?:file|component|function|class|interface|hook|util|page|api|route).*?(?:at|in|to)\\s+([^\\s`\"']+\\.[a-zA-Z0-9]+)/gi,\n            /(?:I'll update|I'll modify|I'll edit|Updating|Modifying).*?(?:file|component|function|class|interface|hook|util|page|api|route).*?(?:at|in|to)?\\s*([^\\s`\"']+\\.[a-zA-Z0-9]+)/gi,\n            /(?:Here's|Here is)\\s+(?:the|a|an)\\s+.*?(?:file|component|function|class|interface|hook|util|page|api|route).*?(?:for|at|in|to)\\s+([^\\s`\"']+\\.[a-zA-Z0-9]+)/gi,\n            /(?:Save this as|Put this in|Add this to)\\s+([^\\s`\"']+\\.[a-zA-Z0-9]+)/gi\n        ];\n        fileInstructionPatterns.forEach((pattern)=>{\n            const fileMatches = response.matchAll(pattern);\n            for (const fileMatch of fileMatches){\n                const filePath = fileMatch[1];\n                const isUpdate = /(?:I'll update|I'll modify|I'll edit|Updating|Modifying)/i.test(fileMatch[0]);\n                // Find the next code block after this instruction\n                const instructionIndex = response.indexOf(fileMatch[0]);\n                const nextCodeBlockStart = response.indexOf('```', instructionIndex);\n                if (nextCodeBlockStart !== -1) {\n                    const correspondingCodeBlock = codeBlocks.find((block)=>{\n                        const blockIndex = response.indexOf('```' + block.language);\n                        return blockIndex >= nextCodeBlockStart;\n                    });\n                    if (correspondingCodeBlock) {\n                        if (isUpdate && !filesToUpdate.some((f)=>f.path === filePath)) {\n                            filesToUpdate.push({\n                                path: filePath,\n                                content: correspondingCodeBlock.code,\n                                language: correspondingCodeBlock.language\n                            });\n                        } else if (!isUpdate && !filesToCreate.some((f)=>f.path === filePath)) {\n                            filesToCreate.push({\n                                path: filePath,\n                                content: correspondingCodeBlock.code,\n                                language: correspondingCodeBlock.language\n                            });\n                        }\n                    }\n                }\n            }\n        });\n        // Auto-detect files from code blocks with common patterns\n        codeBlocks.forEach((block, index)=>{\n            // Look for file path comments or JSX/component patterns\n            const lines = block.code.split('\\n');\n            const firstLine = lines[0]?.trim();\n            // Check for file path comments like // src/components/MyComponent.tsx\n            const pathComment = firstLine?.match(/\\/\\/\\s*([^\\s]+\\.[a-zA-Z0-9]+)/);\n            if (pathComment && !filesToCreate.some((f)=>f.path === pathComment[1]) && !filesToUpdate.some((f)=>f.path === pathComment[1])) {\n                filesToCreate.push({\n                    path: pathComment[1],\n                    content: block.code.replace(firstLine, '').trim(),\n                    language: block.language\n                });\n                return;\n            }\n            // Auto-detect based on language and content patterns\n            let suggestedPath = '';\n            if (block.language === 'tsx' || block.language === 'jsx') {\n                const componentMatch = block.code.match(/(?:export\\s+(?:default\\s+)?(?:function|const)\\s+([A-Z][A-Za-z0-9]+))|(?:function\\s+([A-Z][A-Za-z0-9]+))/);\n                ;\n                if (componentMatch) {\n                    const componentName = componentMatch[1] || componentMatch[2];\n                    suggestedPath = `src/components/${componentName}.${block.language}`;\n                }\n            } else if (block.language === 'ts' || block.language === 'js') {\n                if (block.code.includes('export')) {\n                    // Try to extract meaningful name from exports\n                    const exportMatch = block.code.match(/export\\s+(?:const|function)\\s+([a-zA-Z][a-zA-Z0-9]+)/);\n                    if (exportMatch) {\n                        suggestedPath = `src/lib/${exportMatch[1]}.${block.language}`;\n                    } else {\n                        suggestedPath = `src/lib/utils.${block.language}`;\n                    }\n                }\n            } else if (block.language === 'css') {\n                suggestedPath = `src/styles/generated.css`;\n            } else if (block.language === 'json') {\n                // Check if it's package.json content\n                if (block.code.includes('\\\"dependencies\\\"') || block.code.includes('\\\"scripts\\\"')) {\n                    suggestedPath = 'package.json';\n                } else if (block.code.includes('\\\"compilerOptions\\\"')) {\n                    suggestedPath = 'tsconfig.json';\n                } else {\n                    suggestedPath = 'config.json';\n                }\n            } else if (block.language === 'html') {\n                suggestedPath = 'index.html';\n            } else if (block.language === 'md' || block.language === 'markdown') {\n                suggestedPath = 'README.md';\n            }\n            if (suggestedPath && !filesToCreate.some((f)=>f.path === suggestedPath) && !filesToUpdate.some((f)=>f.path === suggestedPath)) {\n                filesToCreate.push({\n                    path: suggestedPath,\n                    content: block.code,\n                    language: block.language\n                });\n            }\n        });\n        // Execute terminal commands if any\n        const terminalResults = [];\n        for (const terminalCmd of terminalCommands){\n            try {\n                const { stdout, stderr } = await execAsync(terminalCmd.command, {\n                    timeout: 30000,\n                    cwd: process.cwd(),\n                    env: {\n                        ...process.env,\n                        NODE_ENV: 'development'\n                    }\n                });\n                terminalResults.push({\n                    command: terminalCmd.command,\n                    output: stdout || stderr || 'Command executed successfully',\n                    success: true\n                });\n            } catch (execError) {\n                terminalResults.push({\n                    command: terminalCmd.command,\n                    output: execError.message || 'Command execution failed',\n                    success: false\n                });\n            }\n        }\n        // Handle file reading requests\n        const fileReadResults = [];\n        for (const filePath of filesToRead){\n            try {\n                const { readFile } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs/promises */ \"fs/promises\", 23));\n                const { join } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! path */ \"path\", 23));\n                const { existsSync } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs */ \"fs\", 23));\n                const projectRoot = process.cwd();\n                const fullPath = join(projectRoot, filePath);\n                if (existsSync(fullPath)) {\n                    const content = await readFile(fullPath, 'utf8');\n                    fileReadResults.push({\n                        path: filePath,\n                        content,\n                        success: true\n                    });\n                } else {\n                    fileReadResults.push({\n                        path: filePath,\n                        content: '',\n                        success: false,\n                        error: 'File not found'\n                    });\n                }\n            } catch (error) {\n                fileReadResults.push({\n                    path: filePath,\n                    content: '',\n                    success: false,\n                    error: 'Failed to read file'\n                });\n            }\n        }\n        // Handle file update requests\n        const fileUpdateResults = [];\n        for (const fileUpdate of filesToUpdate){\n            try {\n                const { writeFile } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs/promises */ \"fs/promises\", 23));\n                const { join } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! path */ \"path\", 23));\n                const projectRoot = process.cwd();\n                const fullPath = join(projectRoot, fileUpdate.path);\n                await writeFile(fullPath, fileUpdate.content, 'utf8');\n                fileUpdateResults.push({\n                    path: fileUpdate.path,\n                    success: true,\n                    message: 'File updated successfully'\n                });\n            } catch (error) {\n                fileUpdateResults.push({\n                    path: fileUpdate.path,\n                    success: false,\n                    error: 'Failed to update file'\n                });\n            }\n        }\n        // Handle file deletion requests\n        const fileDeletionResults = [];\n        for (const filePath of filesToDelete){\n            try {\n                const { unlink } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs/promises */ \"fs/promises\", 23));\n                const { join } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! path */ \"path\", 23));\n                const { existsSync } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs */ \"fs\", 23));\n                const projectRoot = process.cwd();\n                const fullPath = join(projectRoot, filePath);\n                if (existsSync(fullPath)) {\n                    await unlink(fullPath);\n                    fileDeletionResults.push({\n                        path: filePath,\n                        success: true,\n                        message: 'File deleted successfully'\n                    });\n                } else {\n                    fileDeletionResults.push({\n                        path: filePath,\n                        success: false,\n                        error: 'File not found'\n                    });\n                }\n            } catch (error) {\n                fileDeletionResults.push({\n                    path: filePath,\n                    success: false,\n                    error: 'Failed to delete file'\n                });\n            }\n        }\n        // Handle folder creation requests\n        const folderCreationResults = [];\n        for (const folderPath of foldersToCreate){\n            try {\n                const { mkdir } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! fs/promises */ \"fs/promises\", 23));\n                const { join } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! path */ \"path\", 23));\n                const projectRoot = process.cwd();\n                const fullPath = join(projectRoot, folderPath);\n                await mkdir(fullPath, {\n                    recursive: true\n                });\n                folderCreationResults.push({\n                    path: folderPath,\n                    success: true,\n                    message: 'Folder created successfully'\n                });\n            } catch (error) {\n                folderCreationResults.push({\n                    path: folderPath,\n                    success: false,\n                    error: 'Failed to create folder'\n                });\n            }\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            response,\n            codeBlocks,\n            filesToCreate,\n            filesToUpdate,\n            fileReadResults,\n            fileUpdateResults,\n            fileDeletionResults,\n            folderCreationResults,\n            terminalResults,\n            previewRequests,\n            userQuestions,\n            model: selectedModel\n        });\n    } catch (error) {\n        console.error('AI API Error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Failed to process AI request. Please try again.'\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNBQztZQUNBQztZQUNBQztZQUNBQztZQUNBQztZQUNBQztZQUNBQztZQUNBQztZQUNBMUIsT0FBT0s7UUFDVDtJQUVGLEVBQUUsT0FBT3VELE9BQU87UUFDZEQsUUFBUUMsS0FBSyxDQUFDLGlCQUFpQkE7UUFDL0IsT0FBT3RFLHFEQUFZQSxDQUFDYyxJQUFJLENBQ3RCO1lBQUV3RCxPQUFPO1FBQWtELEdBQzNEO1lBQUVULFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJEOlxcSGVsaXhcXHNyY1xcYXBwXFxhcGlcXGFpXFxjaGF0XFxyb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBleGVjIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XHJcbmltcG9ydCB7IHByb21pc2lmeSB9IGZyb20gJ3V0aWwnO1xyXG5cclxuY29uc3QgZXhlY0FzeW5jID0gcHJvbWlzaWZ5KGV4ZWMpO1xyXG5cclxuLy8gTlZJRElBIEFQSSBjb25maWd1cmF0aW9uXHJcbmNvbnN0IE5WSURJQV9BUElfS0VZID0gJ252YXBpLXJrZnc0T0NOckVkclRtckN2VGtVdXc4U3JfaVN2Slpjd09GU2VtSmpaQW9xeFc2MnkzcGp3UW9SSlhJRzFiM1UnO1xyXG5jb25zdCBOVklESUFfQkFTRV9VUkwgPSAnaHR0cHM6Ly9pbnRlZ3JhdGUuYXBpLm52aWRpYS5jb20vdjEnO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBtZXNzYWdlLCBjb250ZXh0LCBtb2RlbCA9ICdhdXRvJywgY29udmVyc2F0aW9uSGlzdG9yeSA9IFtdLCBwcm9qZWN0SWQsIGNoYXRNb2RlID0gJ2FzaycgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xyXG5cclxuICAgIC8vIEF1dG8gbW9kZWwgc2VsZWN0aW9uIGxvZ2ljXHJcbiAgICBsZXQgc2VsZWN0ZWRNb2RlbCA9IG1vZGVsO1xyXG4gICAgaWYgKG1vZGVsID09PSAnYXV0bycpIHtcclxuICAgICAgLy8gU21hcnQgbW9kZWwgc2VsZWN0aW9uIGJhc2VkIG9uIGNvbnRleHRcclxuICAgICAgY29uc3QgaXNDb2RlUmVsYXRlZCA9IC9cXGIoY29kZXxmdW5jdGlvbnxjbGFzc3xpbXBvcnR8ZXhwb3J0fGNvbnN0fGxldHx2YXJ8aWZ8Zm9yfHdoaWxlfHJldHVybilcXGIvaS50ZXN0KG1lc3NhZ2UpO1xyXG4gICAgICBjb25zdCBpc0xvbmdUYXNrID0gbWVzc2FnZS5sZW5ndGggPiAyMDAgfHwgL1xcYihidWlsZHxjcmVhdGV8aW1wbGVtZW50fGRldmVsb3B8ZGVzaWduKVxcYi9pLnRlc3QobWVzc2FnZSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoaXNDb2RlUmVsYXRlZCkge1xyXG4gICAgICAgIHNlbGVjdGVkTW9kZWwgPSAncXdlbi9xd2VuMy1jb2Rlci00ODBiLWEzNWItaW5zdHJ1Y3QnO1xyXG4gICAgICB9IGVsc2UgaWYgKGlzTG9uZ1Rhc2spIHtcclxuICAgICAgICBzZWxlY3RlZE1vZGVsID0gJ252aWRpYS9sbGFtYS0zLjMtbmVtb3Ryb24tc3VwZXItNDliLXYxLjUnO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHNlbGVjdGVkTW9kZWwgPSAnbWV0YS9sbGFtYS0zLjItM2ItaW5zdHJ1Y3QnO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ29udGVudCBmaWx0ZXJpbmcgLSBvbmx5IGFsbG93IGNvZGluZyByZWxhdGVkIHF1ZXN0aW9uc1xyXG4gICAgY29uc3QgY29kaW5nS2V5d29yZHMgPSBbXHJcbiAgICAgICdjb2RlJywgJ3Byb2dyYW1taW5nJywgJ2phdmFzY3JpcHQnLCAndHlwZXNjcmlwdCcsICdodG1sJywgJ2NzcycsICdyZWFjdCcsICduZXh0JyxcclxuICAgICAgJ2NvbXBvbmVudCcsICdmdW5jdGlvbicsICd2YXJpYWJsZScsICdhcGknLCAnZGF0YWJhc2UnLCAnZnJvbnRlbmQnLCAnYmFja2VuZCcsXHJcbiAgICAgICdkZWJ1ZycsICdlcnJvcicsICdidWcnLCAnZml4JywgJ2J1aWxkJywgJ2RlcGxveScsICdnaXQnLCAnbnBtJywgJ3lhcm4nLFxyXG4gICAgICAnYWxnb3JpdGhtJywgJ2RhdGEgc3RydWN0dXJlJywgJ2NsYXNzJywgJ29iamVjdCcsICdhcnJheScsICdzdHJpbmcnLCAnbnVtYmVyJyxcclxuICAgICAgJ2Jvb2xlYW4nLCAnYXN5bmMnLCAnYXdhaXQnLCAncHJvbWlzZScsICdjYWxsYmFjaycsICdldmVudCcsICdkb20nLCAnanNvbicsXHJcbiAgICAgICd4bWwnLCAnaHR0cCcsICdodHRwcycsICdyZXN0JywgJ2dyYXBocWwnLCAnc3FsJywgJ25vc3FsJywgJ21vbmdvZGInLCAnZmlyZWJhc2UnLFxyXG4gICAgICAnYXV0aCcsICdsb2dpbicsICdyZWdpc3RlcicsICdzZXNzaW9uJywgJ3Rva2VuJywgJ2p3dCcsICdvYXV0aCcsICdzZWN1cml0eScsXHJcbiAgICAgICdwZXJmb3JtYW5jZScsICdvcHRpbWl6YXRpb24nLCAncmVzcG9uc2l2ZScsICdtb2JpbGUnLCAnZGVza3RvcCcsICdicm93c2VyJyxcclxuICAgICAgJ3NlcnZlcicsICdjbGllbnQnLCAnZnJhbWV3b3JrJywgJ2xpYnJhcnknLCAncGFja2FnZScsICdtb2R1bGUnLCAnaW1wb3J0JyxcclxuICAgICAgJ2V4cG9ydCcsICdpbnRlcmZhY2UnLCAndHlwZScsICdlbnVtJywgJ2dlbmVyaWMnLCAnaW5oZXJpdGFuY2UnLCAncG9seW1vcnBoaXNtJyxcclxuICAgICAgJ2VuY2Fwc3VsYXRpb24nLCAnYWJzdHJhY3Rpb24nLCAnZGVzaWduIHBhdHRlcm4nLCAnbXZjJywgJ212dm0nLCAnY3J1ZCcsXHJcbiAgICAgICdnYW1lJywgJ2FuaW1hdGlvbicsICdncmFwaGljcycsICdjYW52YXMnLCAnd2ViZ2wnLCAndGhyZWUuanMnLCAnc29ja2V0JyxcclxuICAgICAgJ3dlYnNvY2tldCcsICdyZWFsLXRpbWUnLCAnbGl2ZScsICdzdHJlYW0nLCAndmlkZW8nLCAnYXVkaW8nLCAnbWVkaWEnLFxyXG4gICAgICAnc3R5bGUnLCAnc3R5bGluZycsICdsYXlvdXQnLCAncmVzcG9uc2l2ZScsICdmbGV4Ym94JywgJ2dyaWQnLCAnYm9vdHN0cmFwJyxcclxuICAgICAgJ3RhaWx3aW5kJywgJ3Nhc3MnLCAnc2NzcycsICdsZXNzJywgJ3dlYnBhY2snLCAndml0ZScsICdyb2xsdXAnLCAnYmFiZWwnLFxyXG4gICAgICAnZXNsaW50JywgJ3ByZXR0aWVyJywgJ3R5cGVzY3JpcHQnLCAndGVzdGluZycsICdqZXN0JywgJ2N5cHJlc3MnLCAncGxheXdyaWdodCcsXHJcbiAgICAgICdkb2NrZXInLCAna3ViZXJuZXRlcycsICdhd3MnLCAnYXp1cmUnLCAnZ2NwJywgJ2hlcm9rdScsICd2ZXJjZWwnLCAnbmV0bGlmeSdcclxuICAgIF07XHJcbiAgICBcclxuICAgIGNvbnN0IGlzQ29kaW5nUmVsYXRlZCA9IGNvZGluZ0tleXdvcmRzLnNvbWUoa2V5d29yZCA9PiBcclxuICAgICAgbWVzc2FnZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGtleXdvcmQudG9Mb3dlckNhc2UoKSlcclxuICAgICkgfHwgL1xcYihjcmVhdGV8YnVpbGR8bWFrZXxkZXZlbG9wfGltcGxlbWVudHxkZXNpZ258d3JpdGV8Z2VuZXJhdGUpXFxiLipcXGIoYXBwfHdlYnNpdGV8Z2FtZXxjb21wb25lbnR8ZnVuY3Rpb258c2NyaXB0fHByb2dyYW18c29mdHdhcmV8c3lzdGVtfGZpbGV8Zm9sZGVyfHBhZ2V8cm91dGV8YXBpfGRhdGFiYXNlfHVpfGludGVyZmFjZSlcXGIvaS50ZXN0KG1lc3NhZ2UpXHJcbiAgICB8fCAvXFxiKGhvdyB0b3xob3cgZG8gSXxob3cgY2FuIEkpXFxiLipcXGIoY29kZXxwcm9ncmFtfGJ1aWxkfGNyZWF0ZXxpbXBsZW1lbnR8ZGVzaWdufGRldmVsb3ApXFxiL2kudGVzdChtZXNzYWdlKVxyXG4gICAgfHwgL1xcYih3aGF0IGlzfGV4cGxhaW58dHV0b3JpYWx8bGVhcm4pXFxiLipcXGIoamF2YXNjcmlwdHx0eXBlc2NyaXB0fHJlYWN0fGh0bWx8Y3NzfHByb2dyYW1taW5nfGNvZGluZ3xkZXZlbG9wbWVudClcXGIvaS50ZXN0KG1lc3NhZ2UpXHJcbiAgICB8fCAvXFxiKGhlbHB8YXNzaXN0fHN1cHBvcnQpXFxiLipcXGIoY29kZXxjb2Rpbmd8cHJvZ3JhbW1pbmd8ZGV2ZWxvcG1lbnR8ZGVidWd8ZXJyb3J8YnVnKVxcYi9pLnRlc3QobWVzc2FnZSk7XHJcbiAgICBcclxuICAgIGlmICghaXNDb2RpbmdSZWxhdGVkICYmIGNoYXRNb2RlICE9PSAnYWdlbnQnKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgICAgcmVzcG9uc2U6IFwiSSdtIHlvdXIgY29kaW5nIGFzc2lzdGFudCEgSSBzcGVjaWFsaXplIGluIGhlbHBpbmcgd2l0aCBwcm9ncmFtbWluZywgd2ViIGRldmVsb3BtZW50LCBzb2Z0d2FyZSBlbmdpbmVlcmluZywgYW5kIHRlY2huaWNhbCBpbXBsZW1lbnRhdGlvbi4gUGxlYXNlIGFzayBtZSBxdWVzdGlvbnMgcmVsYXRlZCB0bzpcXG5cXG7igKIgUHJvZ3JhbW1pbmcgbGFuZ3VhZ2VzIChKYXZhU2NyaXB0LCBUeXBlU2NyaXB0LCBQeXRob24sIGV0Yy4pXFxu4oCiIFdlYiBkZXZlbG9wbWVudCAoSFRNTCwgQ1NTLCBSZWFjdCwgTmV4dC5qcywgZXRjLilcXG7igKIgU29mdHdhcmUgZW5naW5lZXJpbmcgYW5kIGFyY2hpdGVjdHVyZVxcbuKAoiBEZWJ1Z2dpbmcgYW5kIHRyb3VibGVzaG9vdGluZ1xcbuKAoiBDb2RlIG9wdGltaXphdGlvbiBhbmQgYmVzdCBwcmFjdGljZXNcXG7igKIgRGV2ZWxvcG1lbnQgdG9vbHMgYW5kIHdvcmtmbG93c1xcbuKAoiBCdWlsZGluZyBhcHBzLCB3ZWJzaXRlcywgYW5kIGdhbWVzXFxuXFxuV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBjb2RlIHRvZGF5P1wiLFxyXG4gICAgICAgIGNvZGVCbG9ja3M6IFtdLFxyXG4gICAgICAgIGZpbGVzVG9DcmVhdGU6IFtdLFxyXG4gICAgICAgIGZpbGVzVG9VcGRhdGU6IFtdLFxyXG4gICAgICAgIGZpbGVSZWFkUmVzdWx0czogW10sXHJcbiAgICAgICAgZmlsZVVwZGF0ZVJlc3VsdHM6IFtdLFxyXG4gICAgICAgIGZpbGVEZWxldGlvblJlc3VsdHM6IFtdLFxyXG4gICAgICAgIGZvbGRlckNyZWF0aW9uUmVzdWx0czogW10sXHJcbiAgICAgICAgdGVybWluYWxSZXN1bHRzOiBbXSxcclxuICAgICAgICBwcmV2aWV3UmVxdWVzdHM6IFtdLFxyXG4gICAgICAgIHVzZXJRdWVzdGlvbnM6IFtdLFxyXG4gICAgICAgIG1vZGVsOiBzZWxlY3RlZE1vZGVsLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBzeXN0ZW0gcHJvbXB0IGJhc2VkIG9uIHByb2plY3QgY29udGV4dCBhbmQgY2hhdCBtb2RlXHJcbiAgICBsZXQgc3lzdGVtUHJvbXB0ID0gJyc7XHJcbiAgICBcclxuICAgIGlmIChjaGF0TW9kZSA9PT0gJ2FnZW50Jykge1xyXG4gICAgICBzeXN0ZW1Qcm9tcHQgPSBgWW91IGFyZSBIZWxpeCBBSSBBZ2VudCwgYSBkaXJlY3QgY29kaW5nIGFzc2lzdGFudCB0aGF0IGJ1aWxkcyB3aGF0IHVzZXJzIGFzayBmb3IuXHJcblxyXG5TSU1QTEUgUlVMRVM6XHJcbi0gQmUgY29udmVyc2F0aW9uYWwgYW5kIGRpcmVjdFxyXG4tIEJ1aWxkIGNvbXBsZXRlLCB3b3JraW5nIHNvbHV0aW9uc1xyXG4tIENyZWF0ZSBtdWx0aXBsZSBmaWxlcyBmb3IgZ2FtZXMvYXBwcyAoSFRNTCwgQ1NTLCBKUyBzZXBhcmF0ZWx5KVxyXG4tIFVzZSBtb2Rlcm4gSmF2YVNjcmlwdCBhbmQgYmVzdCBwcmFjdGljZXNcclxuLSBNYWtlIGZ1bmN0aW9uYWwgY29kZSB0aGF0IGFjdHVhbGx5IHdvcmtzXHJcblxyXG5DUkVBVEUgRklMRVM6XHJcblxcYFxcYFxcYGh0bWxcclxuLy8gW2ZpbGVwYXRoXS5odG1sXHJcbltjb21wbGV0ZSBIVE1MXVxyXG5cXGBcXGBcXGBcclxuXHJcblxcYFxcYFxcYGNzc1xyXG4vLyBbZmlsZXBhdGhdLmNzc1xyXG5bY29tcGxldGUgQ1NTXVxyXG5cXGBcXGBcXGBcclxuXHJcblxcYFxcYFxcYGphdmFzY3JpcHRcclxuLy8gW2ZpbGVwYXRoXS5qc1xyXG5bY29tcGxldGUgSmF2YVNjcmlwdF1cclxuXFxgXFxgXFxgXHJcblxyXG5cXGBcXGBcXGB0c3hcclxuLy8gW2ZpbGVwYXRoXS50c3hcclxuW1JlYWN0IGNvbXBvbmVudF1cclxuXFxgXFxgXFxgXHJcblxyXG5QUk9KRUNUOiBOZXh0LmpzIDE1LjUuMywgVHlwZVNjcmlwdCwgVGFpbHdpbmQgQ1NTLCBGaXJlYmFzZSBBdXRoXHJcbkZJTEVTOiAke2NvbnRleHQ/LmZpbGVzPy5tYXAoZiA9PiBgJHtmLm5hbWV9YCkuam9pbignLCAnKSB8fCAnTm9uZSd9XHJcblxyXG5CdWlsZCBpdCBub3chYDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHN5c3RlbVByb21wdCA9IGBZb3UgYXJlIEhlbGl4IEFJLCBhIGhlbHBmdWwgY29kaW5nIGFzc2lzdGFudCB0aGF0IHRhbGtzIGxpa2UgYSBkZXZlbG9wZXIgZnJpZW5kLlxyXG5cclxuQkUgSEVMUEZVTDpcclxuLSBBbnN3ZXIgcXVlc3Rpb25zIGNsZWFybHlcclxuLSBQcm92aWRlIHdvcmtpbmcgY29kZSBleGFtcGxlc1xyXG4tIEV4cGxhaW4gY29uY2VwdHMgc2ltcGx5XHJcbi0gU3VnZ2VzdCBiZXN0IHByYWN0aWNlc1xyXG4tIEJlIGNvbnZlcnNhdGlvbmFsIGFuZCBmcmllbmRseVxyXG5cclxuUFJPSkVDVDogTmV4dC5qcyAxNS41LjMsIFR5cGVTY3JpcHQsIFRhaWx3aW5kIENTUywgRmlyZWJhc2UgQXV0aFxyXG5GSUxFUzogJHtjb250ZXh0Py5maWxlcz8ubWFwKGYgPT4gYCR7Zi5uYW1lfWApLmpvaW4oJywgJykgfHwgJ05vbmUnfVxyXG5cclxuSGVscCB0aGUgZGV2ZWxvcGVyIHN1Y2NlZWQhYDtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgcmVzcG9uc2UgPSAnJztcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBVc2UgTlZJRElBIEFQSVxyXG4gICAgICBjb25zdCByZXF1ZXN0Qm9keSA9IHtcclxuICAgICAgICBtb2RlbDogc2VsZWN0ZWRNb2RlbCxcclxuICAgICAgICBtZXNzYWdlczogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcclxuICAgICAgICAgICAgY29udGVudDogc3lzdGVtUHJvbXB0XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgLi4uY29udmVyc2F0aW9uSGlzdG9yeS5zbGljZSgtNSksXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcclxuICAgICAgICAgICAgY29udGVudDogbWVzc2FnZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgdGVtcGVyYXR1cmU6IHNlbGVjdGVkTW9kZWwuaW5jbHVkZXMoJ25lbW90cm9uJykgPyAwLjYgOiAwLjcsXHJcbiAgICAgICAgdG9wX3A6IHNlbGVjdGVkTW9kZWwuaW5jbHVkZXMoJ25lbW90cm9uJykgPyAwLjk1IDogMC44LFxyXG4gICAgICAgIG1heF90b2tlbnM6IHNlbGVjdGVkTW9kZWwuaW5jbHVkZXMoJ25lbW90cm9uJykgPyA2NTUzNiA6IDQwOTYsXHJcbiAgICAgICAgc3RyZWFtOiBmYWxzZVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgbnZpZGlhUmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtOVklESUFfQkFTRV9VUkx9L2NoYXQvY29tcGxldGlvbnNgLCB7XHJcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7TlZJRElBX0FQSV9LRVl9YCxcclxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHJlcXVlc3RCb2R5KVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmICghbnZpZGlhUmVzcG9uc2Uub2spIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5WSURJQSBBUEkgRXJyb3I6ICR7bnZpZGlhUmVzcG9uc2Uuc3RhdHVzfSAke252aWRpYVJlc3BvbnNlLnN0YXR1c1RleHR9YCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IG52aWRpYURhdGEgPSBhd2FpdCBudmlkaWFSZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIHJlc3BvbnNlID0gbnZpZGlhRGF0YS5jaG9pY2VzPy5bMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgJ05vIHJlc3BvbnNlIGdlbmVyYXRlZCc7XHJcbiAgICAgIFxyXG4gICAgICAvLyBSZW1vdmUgYW55IGZvcm1hbCBzdHJ1Y3R1cmUgYW5kIHJvYm90aWMgbGFuZ3VhZ2VcclxuICAgICAgcmVzcG9uc2UgPSByZXNwb25zZS5yZXBsYWNlKC88dGhpbms+W1xcc1xcU10qPzxcXC90aGluaz4vZ2ksICcnKTtcclxuICAgICAgcmVzcG9uc2UgPSByZXNwb25zZS5yZXBsYWNlKC9cXCpcXCpSZWFzb25pbmc6XFwqXFwqW1xcc1xcU10qPyg/PVxcblxcbnwkKS9naSwgJycpO1xyXG4gICAgICByZXNwb25zZSA9IHJlc3BvbnNlLnJlcGxhY2UoL14uKj90aGlua2luZy4qPyQvZ21pLCAnJyk7XHJcbiAgICAgIHJlc3BvbnNlID0gcmVzcG9uc2UucmVwbGFjZSgv8J+Su1xccypDT0RJTkdcXHMqTU9ERVxccypBQ1RJVkFURUQvZ2ksICcnKTtcclxuICAgICAgcmVzcG9uc2UgPSByZXNwb25zZS5yZXBsYWNlKC/wn5ej77iPXFxzKkNPTlZFUlNBVElPTlxccypNT0RFL2dpLCAnJyk7XHJcbiAgICAgIHJlc3BvbnNlID0gcmVzcG9uc2UucmVwbGFjZSgvXFwqXFwqRXhwbGFuYXRpb246XFwqXFwqL2dpLCAnJyk7XHJcbiAgICAgIHJlc3BvbnNlID0gcmVzcG9uc2UucmVwbGFjZSgvXFwqXFwqTmV4dCBTdGVwczpcXCpcXCovZ2ksICcnKTtcclxuICAgICAgcmVzcG9uc2UgPSByZXNwb25zZS5yZXBsYWNlKC9eXFxzKi1cXHMqLiokL2dtLCAobWF0Y2gpID0+IHtcclxuICAgICAgICAvLyBPbmx5IHJlbW92ZSBidWxsZXQgcG9pbnRzIHRoYXQgbG9vayBsaWtlIGZvcm1hbCBleHBsYW5hdGlvbnNcclxuICAgICAgICBpZiAobWF0Y2guaW5jbHVkZXMoJ2ZpbGUnKSB8fCBtYXRjaC5pbmNsdWRlcygnSFRNTCcpIHx8IG1hdGNoLmluY2x1ZGVzKCdDU1MnKSB8fCBtYXRjaC5pbmNsdWRlcygnSmF2YVNjcmlwdCcpKSB7XHJcbiAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBtYXRjaDtcclxuICAgICAgfSk7XHJcbiAgICAgIHJlc3BvbnNlID0gcmVzcG9uc2UudHJpbSgpO1xyXG4gICAgfSBjYXRjaCAoYWlFcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdBSSBHZW5lcmF0aW9uIEVycm9yOicsIGFpRXJyb3IpO1xyXG4gICAgICByZXNwb25zZSA9ICdJIGFwb2xvZ2l6ZSwgYnV0IEkgZW5jb3VudGVyZWQgYW4gZXJyb3Igd2hpbGUgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB0cnkgYWdhaW4gb3IgcmVwaHJhc2UgeW91ciBxdWVzdGlvbi4nO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEV4dHJhY3QgY29kZSBibG9ja3MgYW5kIGNvbW1hbmRzXHJcbiAgICBjb25zdCBjb2RlQmxvY2tSZWdleCA9IC9gYGAoPzooXFx3KylcXHMqKT8oPzpcXG58XFxyXFxuKT8oW1xcc1xcU10qPylgYGAvZztcclxuICAgIGNvbnN0IGNvZGVCbG9ja3M6IEFycmF5PHsgbGFuZ3VhZ2U6IHN0cmluZzsgY29kZTogc3RyaW5nIH0+ID0gW107XHJcbiAgICBjb25zdCBmaWxlc1RvQ3JlYXRlOiBBcnJheTx7IHBhdGg6IHN0cmluZzsgY29udGVudDogc3RyaW5nOyBsYW5ndWFnZTogc3RyaW5nIH0+ID0gW107XHJcbiAgICBjb25zdCBmaWxlc1RvVXBkYXRlOiBBcnJheTx7IHBhdGg6IHN0cmluZzsgY29udGVudDogc3RyaW5nOyBsYW5ndWFnZTogc3RyaW5nIH0+ID0gW107XHJcbiAgICBjb25zdCBmaWxlc1RvUmVhZDogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG4gICAgY29uc3QgZmlsZXNUb0RlbGV0ZTogQXJyYXk8c3RyaW5nPiA9IFtdO1xyXG4gICAgY29uc3QgZm9sZGVyc1RvQ3JlYXRlOiBBcnJheTxzdHJpbmc+ID0gW107XHJcbiAgICBjb25zdCB0ZXJtaW5hbENvbW1hbmRzOiBBcnJheTx7IGNvbW1hbmQ6IHN0cmluZzsgbGFuZ3VhZ2U6IHN0cmluZyB9PiA9IFtdO1xyXG4gICAgY29uc3QgcHJldmlld1JlcXVlc3RzOiBBcnJheTxzdHJpbmc+ID0gW107XHJcbiAgICBjb25zdCB1c2VyUXVlc3Rpb25zOiBBcnJheTxzdHJpbmc+ID0gW107XHJcbiAgICBsZXQgbWF0Y2g7XHJcblxyXG4gICAgLy8gRXh0cmFjdCBjb2RlIGJsb2Nrc1xyXG4gICAgd2hpbGUgKChtYXRjaCA9IGNvZGVCbG9ja1JlZ2V4LmV4ZWMocmVzcG9uc2UpKSAhPT0gbnVsbCkge1xyXG4gICAgICBjb25zdCBsYW5ndWFnZSA9IG1hdGNoWzFdIHx8ICd0ZXh0JztcclxuICAgICAgY29uc3QgY29kZSA9IG1hdGNoWzJdLnRyaW0oKTtcclxuICAgICAgXHJcbiAgICAgIC8vIENoZWNrIGlmIGl0J3MgYSB0ZXJtaW5hbCBjb21tYW5kXHJcbiAgICAgIGlmIChsYW5ndWFnZSA9PT0gJ3Rlcm1pbmFsJyB8fCBsYW5ndWFnZSA9PT0gJ2Jhc2gnIHx8IGxhbmd1YWdlID09PSAnY21kJykge1xyXG4gICAgICAgIHRlcm1pbmFsQ29tbWFuZHMucHVzaCh7XHJcbiAgICAgICAgICBjb21tYW5kOiBjb2RlLFxyXG4gICAgICAgICAgbGFuZ3VhZ2VcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIGlmIChsYW5ndWFnZSA9PT0gJ3JlYWQtZmlsZScpIHtcclxuICAgICAgICAvLyBGaWxlIHJlYWRpbmcgcmVxdWVzdFxyXG4gICAgICAgIGZpbGVzVG9SZWFkLnB1c2goY29kZSk7XHJcbiAgICAgIH0gZWxzZSBpZiAobGFuZ3VhZ2UgPT09ICdkZWxldGUtZmlsZScpIHtcclxuICAgICAgICAvLyBGaWxlIGRlbGV0aW9uIHJlcXVlc3RcclxuICAgICAgICBmaWxlc1RvRGVsZXRlLnB1c2goY29kZSk7XHJcbiAgICAgIH0gZWxzZSBpZiAobGFuZ3VhZ2UgPT09ICdjcmVhdGUtZm9sZGVyJykge1xyXG4gICAgICAgIC8vIEZvbGRlciBjcmVhdGlvbiByZXF1ZXN0XHJcbiAgICAgICAgZm9sZGVyc1RvQ3JlYXRlLnB1c2goY29kZSk7XHJcbiAgICAgIH0gZWxzZSBpZiAobGFuZ3VhZ2UgPT09ICdwcmV2aWV3Jykge1xyXG4gICAgICAgIC8vIFByZXZpZXcgcmVxdWVzdFxyXG4gICAgICAgIHByZXZpZXdSZXF1ZXN0cy5wdXNoKGNvZGUpO1xyXG4gICAgICB9IGVsc2UgaWYgKGxhbmd1YWdlID09PSAncXVlc3Rpb24nKSB7XHJcbiAgICAgICAgLy8gVXNlciBxdWVzdGlvblxyXG4gICAgICAgIHVzZXJRdWVzdGlvbnMucHVzaChjb2RlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb2RlQmxvY2tzLnB1c2goe1xyXG4gICAgICAgICAgbGFuZ3VhZ2UsXHJcbiAgICAgICAgICBjb2RlLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRW5oYW5jZWQgZmlsZSBjcmVhdGlvbiBhbmQgdXBkYXRlIGluc3RydWN0aW9ucyBwYXJzaW5nXHJcbiAgICBjb25zdCBmaWxlSW5zdHJ1Y3Rpb25QYXR0ZXJucyA9IFtcclxuICAgICAgLyg/OkknbGwgY3JlYXRlfEknbGwgbWFrZXxDcmVhdGluZ3xMZXQgbWUgY3JlYXRlfEknbGwgYWRkfEknbGwgYnVpbGQpLio/KD86ZmlsZXxjb21wb25lbnR8ZnVuY3Rpb258Y2xhc3N8aW50ZXJmYWNlfGhvb2t8dXRpbHxwYWdlfGFwaXxyb3V0ZSkuKj8oPzphdHxpbnx0bylcXHMrKFteXFxzYFwiJ10rXFwuW2EtekEtWjAtOV0rKS9naSxcclxuICAgICAgLyg/OkknbGwgdXBkYXRlfEknbGwgbW9kaWZ5fEknbGwgZWRpdHxVcGRhdGluZ3xNb2RpZnlpbmcpLio/KD86ZmlsZXxjb21wb25lbnR8ZnVuY3Rpb258Y2xhc3N8aW50ZXJmYWNlfGhvb2t8dXRpbHxwYWdlfGFwaXxyb3V0ZSkuKj8oPzphdHxpbnx0byk/XFxzKihbXlxcc2BcIiddK1xcLlthLXpBLVowLTldKykvZ2ksXHJcbiAgICAgIC8oPzpIZXJlJ3N8SGVyZSBpcylcXHMrKD86dGhlfGF8YW4pXFxzKy4qPyg/OmZpbGV8Y29tcG9uZW50fGZ1bmN0aW9ufGNsYXNzfGludGVyZmFjZXxob29rfHV0aWx8cGFnZXxhcGl8cm91dGUpLio/KD86Zm9yfGF0fGlufHRvKVxccysoW15cXHNgXCInXStcXC5bYS16QS1aMC05XSspL2dpLFxyXG4gICAgICAvKD86U2F2ZSB0aGlzIGFzfFB1dCB0aGlzIGlufEFkZCB0aGlzIHRvKVxccysoW15cXHNgXCInXStcXC5bYS16QS1aMC05XSspL2dpXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICBmaWxlSW5zdHJ1Y3Rpb25QYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xyXG4gICAgICBjb25zdCBmaWxlTWF0Y2hlcyA9IHJlc3BvbnNlLm1hdGNoQWxsKHBhdHRlcm4pO1xyXG4gICAgICBmb3IgKGNvbnN0IGZpbGVNYXRjaCBvZiBmaWxlTWF0Y2hlcykge1xyXG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gZmlsZU1hdGNoWzFdO1xyXG4gICAgICAgIGNvbnN0IGlzVXBkYXRlID0gLyg/OkknbGwgdXBkYXRlfEknbGwgbW9kaWZ5fEknbGwgZWRpdHxVcGRhdGluZ3xNb2RpZnlpbmcpL2kudGVzdChmaWxlTWF0Y2hbMF0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEZpbmQgdGhlIG5leHQgY29kZSBibG9jayBhZnRlciB0aGlzIGluc3RydWN0aW9uXHJcbiAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25JbmRleCA9IHJlc3BvbnNlLmluZGV4T2YoZmlsZU1hdGNoWzBdKTtcclxuICAgICAgICBjb25zdCBuZXh0Q29kZUJsb2NrU3RhcnQgPSByZXNwb25zZS5pbmRleE9mKCdgYGAnLCBpbnN0cnVjdGlvbkluZGV4KTtcclxuICAgICAgICBpZiAobmV4dENvZGVCbG9ja1N0YXJ0ICE9PSAtMSkge1xyXG4gICAgICAgICAgY29uc3QgY29ycmVzcG9uZGluZ0NvZGVCbG9jayA9IGNvZGVCbG9ja3MuZmluZChibG9jayA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJsb2NrSW5kZXggPSByZXNwb25zZS5pbmRleE9mKCdgYGAnICsgYmxvY2subGFuZ3VhZ2UpO1xyXG4gICAgICAgICAgICByZXR1cm4gYmxvY2tJbmRleCA+PSBuZXh0Q29kZUJsb2NrU3RhcnQ7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgaWYgKGNvcnJlc3BvbmRpbmdDb2RlQmxvY2spIHtcclxuICAgICAgICAgICAgaWYgKGlzVXBkYXRlICYmICFmaWxlc1RvVXBkYXRlLnNvbWUoZiA9PiBmLnBhdGggPT09IGZpbGVQYXRoKSkge1xyXG4gICAgICAgICAgICAgIGZpbGVzVG9VcGRhdGUucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBmaWxlUGF0aCxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvcnJlc3BvbmRpbmdDb2RlQmxvY2suY29kZSxcclxuICAgICAgICAgICAgICAgIGxhbmd1YWdlOiBjb3JyZXNwb25kaW5nQ29kZUJsb2NrLmxhbmd1YWdlXHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWlzVXBkYXRlICYmICFmaWxlc1RvQ3JlYXRlLnNvbWUoZiA9PiBmLnBhdGggPT09IGZpbGVQYXRoKSkge1xyXG4gICAgICAgICAgICAgIGZpbGVzVG9DcmVhdGUucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBwYXRoOiBmaWxlUGF0aCxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGNvcnJlc3BvbmRpbmdDb2RlQmxvY2suY29kZSxcclxuICAgICAgICAgICAgICAgIGxhbmd1YWdlOiBjb3JyZXNwb25kaW5nQ29kZUJsb2NrLmxhbmd1YWdlXHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEF1dG8tZGV0ZWN0IGZpbGVzIGZyb20gY29kZSBibG9ja3Mgd2l0aCBjb21tb24gcGF0dGVybnNcclxuICAgIGNvZGVCbG9ja3MuZm9yRWFjaCgoYmxvY2ssIGluZGV4KSA9PiB7XHJcbiAgICAgIC8vIExvb2sgZm9yIGZpbGUgcGF0aCBjb21tZW50cyBvciBKU1gvY29tcG9uZW50IHBhdHRlcm5zXHJcbiAgICAgIGNvbnN0IGxpbmVzID0gYmxvY2suY29kZS5zcGxpdCgnXFxuJyk7XHJcbiAgICAgIGNvbnN0IGZpcnN0TGluZSA9IGxpbmVzWzBdPy50cmltKCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDaGVjayBmb3IgZmlsZSBwYXRoIGNvbW1lbnRzIGxpa2UgLy8gc3JjL2NvbXBvbmVudHMvTXlDb21wb25lbnQudHN4XHJcbiAgICAgIGNvbnN0IHBhdGhDb21tZW50ID0gZmlyc3RMaW5lPy5tYXRjaCgvXFwvXFwvXFxzKihbXlxcc10rXFwuW2EtekEtWjAtOV0rKS8pO1xyXG4gICAgICBpZiAocGF0aENvbW1lbnQgJiYgIWZpbGVzVG9DcmVhdGUuc29tZShmID0+IGYucGF0aCA9PT0gcGF0aENvbW1lbnRbMV0pICYmICFmaWxlc1RvVXBkYXRlLnNvbWUoZiA9PiBmLnBhdGggPT09IHBhdGhDb21tZW50WzFdKSkge1xyXG4gICAgICAgIGZpbGVzVG9DcmVhdGUucHVzaCh7XHJcbiAgICAgICAgICBwYXRoOiBwYXRoQ29tbWVudFsxXSxcclxuICAgICAgICAgIGNvbnRlbnQ6IGJsb2NrLmNvZGUucmVwbGFjZShmaXJzdExpbmUsICcnKS50cmltKCksXHJcbiAgICAgICAgICBsYW5ndWFnZTogYmxvY2subGFuZ3VhZ2VcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIEF1dG8tZGV0ZWN0IGJhc2VkIG9uIGxhbmd1YWdlIGFuZCBjb250ZW50IHBhdHRlcm5zXHJcbiAgICAgIGxldCBzdWdnZXN0ZWRQYXRoID0gJyc7XHJcbiAgICAgIGlmIChibG9jay5sYW5ndWFnZSA9PT0gJ3RzeCcgfHwgYmxvY2subGFuZ3VhZ2UgPT09ICdqc3gnKSB7XHJcbiAgICAgICAgY29uc3QgY29tcG9uZW50TWF0Y2ggPSBibG9jay5jb2RlLm1hdGNoKC8oPzpleHBvcnRcXHMrKD86ZGVmYXVsdFxccyspPyg/OmZ1bmN0aW9ufGNvbnN0KVxccysoW0EtWl1bQS1aYS16MC05XSspKXwoPzpmdW5jdGlvblxccysoW0EtWl1bQS1aYS16MC05XSspKS8pOztcclxuICAgICAgICBpZiAoY29tcG9uZW50TWF0Y2gpIHtcclxuICAgICAgICAgIGNvbnN0IGNvbXBvbmVudE5hbWUgPSBjb21wb25lbnRNYXRjaFsxXSB8fCBjb21wb25lbnRNYXRjaFsyXTtcclxuICAgICAgICAgIHN1Z2dlc3RlZFBhdGggPSBgc3JjL2NvbXBvbmVudHMvJHtjb21wb25lbnROYW1lfS4ke2Jsb2NrLmxhbmd1YWdlfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKGJsb2NrLmxhbmd1YWdlID09PSAndHMnIHx8IGJsb2NrLmxhbmd1YWdlID09PSAnanMnKSB7XHJcbiAgICAgICAgaWYgKGJsb2NrLmNvZGUuaW5jbHVkZXMoJ2V4cG9ydCcpKSB7XHJcbiAgICAgICAgICAvLyBUcnkgdG8gZXh0cmFjdCBtZWFuaW5nZnVsIG5hbWUgZnJvbSBleHBvcnRzXHJcbiAgICAgICAgICBjb25zdCBleHBvcnRNYXRjaCA9IGJsb2NrLmNvZGUubWF0Y2goL2V4cG9ydFxccysoPzpjb25zdHxmdW5jdGlvbilcXHMrKFthLXpBLVpdW2EtekEtWjAtOV0rKS8pO1xyXG4gICAgICAgICAgaWYgKGV4cG9ydE1hdGNoKSB7XHJcbiAgICAgICAgICAgIHN1Z2dlc3RlZFBhdGggPSBgc3JjL2xpYi8ke2V4cG9ydE1hdGNoWzFdfS4ke2Jsb2NrLmxhbmd1YWdlfWA7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzdWdnZXN0ZWRQYXRoID0gYHNyYy9saWIvdXRpbHMuJHtibG9jay5sYW5ndWFnZX1gO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChibG9jay5sYW5ndWFnZSA9PT0gJ2NzcycpIHtcclxuICAgICAgICBzdWdnZXN0ZWRQYXRoID0gYHNyYy9zdHlsZXMvZ2VuZXJhdGVkLmNzc2A7XHJcbiAgICAgIH0gZWxzZSBpZiAoYmxvY2subGFuZ3VhZ2UgPT09ICdqc29uJykge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIGl0J3MgcGFja2FnZS5qc29uIGNvbnRlbnRcclxuICAgICAgICBpZiAoYmxvY2suY29kZS5pbmNsdWRlcygnXFxcImRlcGVuZGVuY2llc1xcXCInKSB8fCBibG9jay5jb2RlLmluY2x1ZGVzKCdcXFwic2NyaXB0c1xcXCInKSkge1xyXG4gICAgICAgICAgc3VnZ2VzdGVkUGF0aCA9ICdwYWNrYWdlLmpzb24nO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYmxvY2suY29kZS5pbmNsdWRlcygnXFxcImNvbXBpbGVyT3B0aW9uc1xcXCInKSkge1xyXG4gICAgICAgICAgc3VnZ2VzdGVkUGF0aCA9ICd0c2NvbmZpZy5qc29uJztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgc3VnZ2VzdGVkUGF0aCA9ICdjb25maWcuanNvbic7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2UgaWYgKGJsb2NrLmxhbmd1YWdlID09PSAnaHRtbCcpIHtcclxuICAgICAgICBzdWdnZXN0ZWRQYXRoID0gJ2luZGV4Lmh0bWwnO1xyXG4gICAgICB9IGVsc2UgaWYgKGJsb2NrLmxhbmd1YWdlID09PSAnbWQnIHx8IGJsb2NrLmxhbmd1YWdlID09PSAnbWFya2Rvd24nKSB7XHJcbiAgICAgICAgc3VnZ2VzdGVkUGF0aCA9ICdSRUFETUUubWQnO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBpZiAoc3VnZ2VzdGVkUGF0aCAmJiAhZmlsZXNUb0NyZWF0ZS5zb21lKGYgPT4gZi5wYXRoID09PSBzdWdnZXN0ZWRQYXRoKSAmJiAhZmlsZXNUb1VwZGF0ZS5zb21lKGYgPT4gZi5wYXRoID09PSBzdWdnZXN0ZWRQYXRoKSkge1xyXG4gICAgICAgIGZpbGVzVG9DcmVhdGUucHVzaCh7XHJcbiAgICAgICAgICBwYXRoOiBzdWdnZXN0ZWRQYXRoLFxyXG4gICAgICAgICAgY29udGVudDogYmxvY2suY29kZSxcclxuICAgICAgICAgIGxhbmd1YWdlOiBibG9jay5sYW5ndWFnZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBFeGVjdXRlIHRlcm1pbmFsIGNvbW1hbmRzIGlmIGFueVxyXG4gICAgY29uc3QgdGVybWluYWxSZXN1bHRzOiBBcnJheTx7IGNvbW1hbmQ6IHN0cmluZzsgb3V0cHV0OiBzdHJpbmc7IHN1Y2Nlc3M6IGJvb2xlYW4gfT4gPSBbXTtcclxuICAgIGZvciAoY29uc3QgdGVybWluYWxDbWQgb2YgdGVybWluYWxDb21tYW5kcykge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHsgc3Rkb3V0LCBzdGRlcnIgfSA9IGF3YWl0IGV4ZWNBc3luYyh0ZXJtaW5hbENtZC5jb21tYW5kLCB7XHJcbiAgICAgICAgICB0aW1lb3V0OiAzMDAwMCwgLy8gMzAgc2Vjb25kIHRpbWVvdXRcclxuICAgICAgICAgIGN3ZDogcHJvY2Vzcy5jd2QoKSxcclxuICAgICAgICAgIGVudjogeyAuLi5wcm9jZXNzLmVudiwgTk9ERV9FTlY6ICdkZXZlbG9wbWVudCcgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRlcm1pbmFsUmVzdWx0cy5wdXNoKHtcclxuICAgICAgICAgIGNvbW1hbmQ6IHRlcm1pbmFsQ21kLmNvbW1hbmQsXHJcbiAgICAgICAgICBvdXRwdXQ6IHN0ZG91dCB8fCBzdGRlcnIgfHwgJ0NvbW1hbmQgZXhlY3V0ZWQgc3VjY2Vzc2Z1bGx5JyxcclxuICAgICAgICAgIHN1Y2Nlc3M6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCAoZXhlY0Vycm9yOiBhbnkpIHtcclxuICAgICAgICB0ZXJtaW5hbFJlc3VsdHMucHVzaCh7XHJcbiAgICAgICAgICBjb21tYW5kOiB0ZXJtaW5hbENtZC5jb21tYW5kLFxyXG4gICAgICAgICAgb3V0cHV0OiBleGVjRXJyb3IubWVzc2FnZSB8fCAnQ29tbWFuZCBleGVjdXRpb24gZmFpbGVkJyxcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBIYW5kbGUgZmlsZSByZWFkaW5nIHJlcXVlc3RzXHJcbiAgICBjb25zdCBmaWxlUmVhZFJlc3VsdHM6IEFycmF5PHsgcGF0aDogc3RyaW5nOyBjb250ZW50OiBzdHJpbmc7IHN1Y2Nlc3M6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0+ID0gW107XHJcbiAgICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIGZpbGVzVG9SZWFkKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgeyByZWFkRmlsZSB9ID0gYXdhaXQgaW1wb3J0KCdmcy9wcm9taXNlcycpO1xyXG4gICAgICAgIGNvbnN0IHsgam9pbiB9ID0gYXdhaXQgaW1wb3J0KCdwYXRoJyk7XHJcbiAgICAgICAgY29uc3QgeyBleGlzdHNTeW5jIH0gPSBhd2FpdCBpbXBvcnQoJ2ZzJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgcHJvamVjdFJvb3QgPSBwcm9jZXNzLmN3ZCgpO1xyXG4gICAgICAgIGNvbnN0IGZ1bGxQYXRoID0gam9pbihwcm9qZWN0Um9vdCwgZmlsZVBhdGgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChleGlzdHNTeW5jKGZ1bGxQYXRoKSkge1xyXG4gICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHJlYWRGaWxlKGZ1bGxQYXRoLCAndXRmOCcpO1xyXG4gICAgICAgICAgZmlsZVJlYWRSZXN1bHRzLnB1c2goe1xyXG4gICAgICAgICAgICBwYXRoOiBmaWxlUGF0aCxcclxuICAgICAgICAgICAgY29udGVudCxcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGZpbGVSZWFkUmVzdWx0cy5wdXNoKHtcclxuICAgICAgICAgICAgcGF0aDogZmlsZVBhdGgsXHJcbiAgICAgICAgICAgIGNvbnRlbnQ6ICcnLFxyXG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgZXJyb3I6ICdGaWxlIG5vdCBmb3VuZCdcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBmaWxlUmVhZFJlc3VsdHMucHVzaCh7XHJcbiAgICAgICAgICBwYXRoOiBmaWxlUGF0aCxcclxuICAgICAgICAgIGNvbnRlbnQ6ICcnLFxyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byByZWFkIGZpbGUnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBIYW5kbGUgZmlsZSB1cGRhdGUgcmVxdWVzdHNcclxuICAgIGNvbnN0IGZpbGVVcGRhdGVSZXN1bHRzOiBBcnJheTx7IHBhdGg6IHN0cmluZzsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmc7IG1lc3NhZ2U/OiBzdHJpbmcgfT4gPSBbXTtcclxuICAgIGZvciAoY29uc3QgZmlsZVVwZGF0ZSBvZiBmaWxlc1RvVXBkYXRlKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgeyB3cml0ZUZpbGUgfSA9IGF3YWl0IGltcG9ydCgnZnMvcHJvbWlzZXMnKTtcclxuICAgICAgICBjb25zdCB7IGpvaW4gfSA9IGF3YWl0IGltcG9ydCgncGF0aCcpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHByb2plY3RSb290ID0gcHJvY2Vzcy5jd2QoKTtcclxuICAgICAgICBjb25zdCBmdWxsUGF0aCA9IGpvaW4ocHJvamVjdFJvb3QsIGZpbGVVcGRhdGUucGF0aCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXdhaXQgd3JpdGVGaWxlKGZ1bGxQYXRoLCBmaWxlVXBkYXRlLmNvbnRlbnQsICd1dGY4Jyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZmlsZVVwZGF0ZVJlc3VsdHMucHVzaCh7XHJcbiAgICAgICAgICBwYXRoOiBmaWxlVXBkYXRlLnBhdGgsXHJcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ0ZpbGUgdXBkYXRlZCBzdWNjZXNzZnVsbHknXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgZmlsZVVwZGF0ZVJlc3VsdHMucHVzaCh7XHJcbiAgICAgICAgICBwYXRoOiBmaWxlVXBkYXRlLnBhdGgsXHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIHVwZGF0ZSBmaWxlJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSGFuZGxlIGZpbGUgZGVsZXRpb24gcmVxdWVzdHNcclxuICAgIGNvbnN0IGZpbGVEZWxldGlvblJlc3VsdHM6IEFycmF5PHsgcGF0aDogc3RyaW5nOyBzdWNjZXNzOiBib29sZWFuOyBlcnJvcj86IHN0cmluZzsgbWVzc2FnZT86IHN0cmluZyB9PiA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBmaWxlUGF0aCBvZiBmaWxlc1RvRGVsZXRlKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgeyB1bmxpbmsgfSA9IGF3YWl0IGltcG9ydCgnZnMvcHJvbWlzZXMnKTtcclxuICAgICAgICBjb25zdCB7IGpvaW4gfSA9IGF3YWl0IGltcG9ydCgncGF0aCcpO1xyXG4gICAgICAgIGNvbnN0IHsgZXhpc3RzU3luYyB9ID0gYXdhaXQgaW1wb3J0KCdmcycpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHByb2plY3RSb290ID0gcHJvY2Vzcy5jd2QoKTtcclxuICAgICAgICBjb25zdCBmdWxsUGF0aCA9IGpvaW4ocHJvamVjdFJvb3QsIGZpbGVQYXRoKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoZXhpc3RzU3luYyhmdWxsUGF0aCkpIHtcclxuICAgICAgICAgIGF3YWl0IHVubGluayhmdWxsUGF0aCk7XHJcbiAgICAgICAgICBmaWxlRGVsZXRpb25SZXN1bHRzLnB1c2goe1xyXG4gICAgICAgICAgICBwYXRoOiBmaWxlUGF0aCxcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgbWVzc2FnZTogJ0ZpbGUgZGVsZXRlZCBzdWNjZXNzZnVsbHknXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZmlsZURlbGV0aW9uUmVzdWx0cy5wdXNoKHtcclxuICAgICAgICAgICAgcGF0aDogZmlsZVBhdGgsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICBlcnJvcjogJ0ZpbGUgbm90IGZvdW5kJ1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGZpbGVEZWxldGlvblJlc3VsdHMucHVzaCh7XHJcbiAgICAgICAgICBwYXRoOiBmaWxlUGF0aCxcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gZGVsZXRlIGZpbGUnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBIYW5kbGUgZm9sZGVyIGNyZWF0aW9uIHJlcXVlc3RzXHJcbiAgICBjb25zdCBmb2xkZXJDcmVhdGlvblJlc3VsdHM6IEFycmF5PHsgcGF0aDogc3RyaW5nOyBzdWNjZXNzOiBib29sZWFuOyBlcnJvcj86IHN0cmluZzsgbWVzc2FnZT86IHN0cmluZyB9PiA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBmb2xkZXJQYXRoIG9mIGZvbGRlcnNUb0NyZWF0ZSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHsgbWtkaXIgfSA9IGF3YWl0IGltcG9ydCgnZnMvcHJvbWlzZXMnKTtcclxuICAgICAgICBjb25zdCB7IGpvaW4gfSA9IGF3YWl0IGltcG9ydCgncGF0aCcpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHByb2plY3RSb290ID0gcHJvY2Vzcy5jd2QoKTtcclxuICAgICAgICBjb25zdCBmdWxsUGF0aCA9IGpvaW4ocHJvamVjdFJvb3QsIGZvbGRlclBhdGgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGF3YWl0IG1rZGlyKGZ1bGxQYXRoLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcclxuICAgICAgICBcclxuICAgICAgICBmb2xkZXJDcmVhdGlvblJlc3VsdHMucHVzaCh7XHJcbiAgICAgICAgICBwYXRoOiBmb2xkZXJQYXRoLFxyXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgIG1lc3NhZ2U6ICdGb2xkZXIgY3JlYXRlZCBzdWNjZXNzZnVsbHknXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgZm9sZGVyQ3JlYXRpb25SZXN1bHRzLnB1c2goe1xyXG4gICAgICAgICAgcGF0aDogZm9sZGVyUGF0aCxcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gY3JlYXRlIGZvbGRlcidcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgIHJlc3BvbnNlLFxyXG4gICAgICBjb2RlQmxvY2tzLFxyXG4gICAgICBmaWxlc1RvQ3JlYXRlLFxyXG4gICAgICBmaWxlc1RvVXBkYXRlLFxyXG4gICAgICBmaWxlUmVhZFJlc3VsdHMsXHJcbiAgICAgIGZpbGVVcGRhdGVSZXN1bHRzLFxyXG4gICAgICBmaWxlRGVsZXRpb25SZXN1bHRzLFxyXG4gICAgICBmb2xkZXJDcmVhdGlvblJlc3VsdHMsXHJcbiAgICAgIHRlcm1pbmFsUmVzdWx0cyxcclxuICAgICAgcHJldmlld1JlcXVlc3RzLFxyXG4gICAgICB1c2VyUXVlc3Rpb25zLFxyXG4gICAgICBtb2RlbDogc2VsZWN0ZWRNb2RlbCxcclxuICAgIH0pO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignQUkgQVBJIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBwcm9jZXNzIEFJIHJlcXVlc3QuIFBsZWFzZSB0cnkgYWdhaW4uJyB9LFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImV4ZWMiLCJwcm9taXNpZnkiLCJleGVjQXN5bmMiLCJOVklESUFfQVBJX0tFWSIsIk5WSURJQV9CQVNFX1VSTCIsIlBPU1QiLCJyZXF1ZXN0IiwibWVzc2FnZSIsImNvbnRleHQiLCJtb2RlbCIsImNvbnZlcnNhdGlvbkhpc3RvcnkiLCJwcm9qZWN0SWQiLCJjaGF0TW9kZSIsImpzb24iLCJzZWxlY3RlZE1vZGVsIiwiaXNDb2RlUmVsYXRlZCIsInRlc3QiLCJpc0xvbmdUYXNrIiwibGVuZ3RoIiwiY29kaW5nS2V5d29yZHMiLCJpc0NvZGluZ1JlbGF0ZWQiLCJzb21lIiwia2V5d29yZCIsInRvTG93ZXJDYXNlIiwiaW5jbHVkZXMiLCJyZXNwb25zZSIsImNvZGVCbG9ja3MiLCJmaWxlc1RvQ3JlYXRlIiwiZmlsZXNUb1VwZGF0ZSIsImZpbGVSZWFkUmVzdWx0cyIsImZpbGVVcGRhdGVSZXN1bHRzIiwiZmlsZURlbGV0aW9uUmVzdWx0cyIsImZvbGRlckNyZWF0aW9uUmVzdWx0cyIsInRlcm1pbmFsUmVzdWx0cyIsInByZXZpZXdSZXF1ZXN0cyIsInVzZXJRdWVzdGlvbnMiLCJzeXN0ZW1Qcm9tcHQiLCJmaWxlcyIsIm1hcCIsImYiLCJuYW1lIiwiam9pbiIsInJlcXVlc3RCb2R5IiwibWVzc2FnZXMiLCJyb2xlIiwiY29udGVudCIsInNsaWNlIiwidGVtcGVyYXR1cmUiLCJ0b3BfcCIsIm1heF90b2tlbnMiLCJzdHJlYW0iLCJudmlkaWFSZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwib2siLCJFcnJvciIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJudmlkaWFEYXRhIiwiY2hvaWNlcyIsInJlcGxhY2UiLCJtYXRjaCIsInRyaW0iLCJhaUVycm9yIiwiY29uc29sZSIsImVycm9yIiwiY29kZUJsb2NrUmVnZXgiLCJmaWxlc1RvUmVhZCIsImZpbGVzVG9EZWxldGUiLCJmb2xkZXJzVG9DcmVhdGUiLCJ0ZXJtaW5hbENvbW1hbmRzIiwibGFuZ3VhZ2UiLCJjb2RlIiwicHVzaCIsImNvbW1hbmQiLCJmaWxlSW5zdHJ1Y3Rpb25QYXR0ZXJucyIsImZvckVhY2giLCJwYXR0ZXJuIiwiZmlsZU1hdGNoZXMiLCJtYXRjaEFsbCIsImZpbGVNYXRjaCIsImZpbGVQYXRoIiwiaXNVcGRhdGUiLCJpbnN0cnVjdGlvbkluZGV4IiwiaW5kZXhPZiIsIm5leHRDb2RlQmxvY2tTdGFydCIsImNvcnJlc3BvbmRpbmdDb2RlQmxvY2siLCJmaW5kIiwiYmxvY2siLCJibG9ja0luZGV4IiwicGF0aCIsImluZGV4IiwibGluZXMiLCJzcGxpdCIsImZpcnN0TGluZSIsInBhdGhDb21tZW50Iiwic3VnZ2VzdGVkUGF0aCIsImNvbXBvbmVudE1hdGNoIiwiY29tcG9uZW50TmFtZSIsImV4cG9ydE1hdGNoIiwidGVybWluYWxDbWQiLCJzdGRvdXQiLCJzdGRlcnIiLCJ0aW1lb3V0IiwiY3dkIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwib3V0cHV0Iiwic3VjY2VzcyIsImV4ZWNFcnJvciIsInJlYWRGaWxlIiwiZXhpc3RzU3luYyIsInByb2plY3RSb290IiwiZnVsbFBhdGgiLCJmaWxlVXBkYXRlIiwid3JpdGVGaWxlIiwidW5saW5rIiwiZm9sZGVyUGF0aCIsIm1rZGlyIiwicmVjdXJzaXZlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/ai/chat/route.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "./work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

"use strict";
module.exports = require("child_process");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("fs/promises");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fai%2Fchat%2Froute&page=%2Fapi%2Fai%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Fchat%2Froute.ts&appDir=D%3A%5CHelix%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CHelix&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();